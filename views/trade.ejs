<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Portfoliotracker - Market</title>
        <link href="trade_style.css" rel="stylesheet">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    </head>
</html>

<body>
  <div id="topBar_id">
    <h1>PORTFOLIOTRACKER</h1>
    <form action="/logout" method="POST" style="display: inline;">
      <button type="submit" id="logoutButton" title="Log ud">
        <span class="material-symbols-outlined">
          account_circle_off
        </span>
      </button>
    </form>
  </div>

  <ul>
    <li><a href="/dashboard"><span class="material-symbols-outlined">dashboard</span>Dashboard</a></li>
    <li><a href="/portfolios"><span class="material-symbols-outlined">folder_open</span>Portfolios</a></li>
    <li><a href="/trade" style="color: gray;"><span class="material-symbols-outlined" style="color: gray;">query_stats</span>Market</a></li>
    <li><a href="/accounts"><span class="material-symbols-outlined">account_balance_wallet</span>Accounts</a></li>
    <li><a href="/profile"><span class="material-symbols-outlined">person</span>Profile</a></li>
  </ul>

      
  <br>
      <div id="stockBox_id">
        <input placeholder="Search stock..." autofocus id="searchStocks_input_id">
        <div id="stockListBox_id" style="color: white"></div>
      </div>
      
      <div id="ViewBuystockBox_id">
        <div id="viewStock_id">
          <span id="aktieNavn_id"></span>
          <div id="myChart"></div>
        </div>
        <div id="StockPurchaseInfo_id">
          <input id="NumberOfStocks_id" type="number" max="99999" min="1" placeholder="1">
          <select name="Vælg portefølje" id="vælgPortefølje_id">
            <option value="">Vælg portefølje</option>
            <option value="">Tech</option>
            <option value="">Food</option>
            <option value="">Defence</option>
          </select>
          <select name="vælg konto" id="vælgKonto_id">
            <option value="">Vælg konto</option>
            <option value="">Gamerkonto</option>
            <option value="">Børnepenge</option>
            <option value="">Madpenge</option>
          </select>
          <button id="BuyStockButton_id">Purchase</button>
        </div>
      </div>

      <form action="/trade" method="POST">
        <button type="submit" name="stockName" value="AAPL">AAPL</button>
        <button type="submit" name="stockName" value="GOOGL">GOOGL</button>
        <button type="submit" name="stockName" value="TSLA">TSLA</button>
      </form>


      <table border="1">
        <thead>
          <tr>
            <th>Dato</th>
            <th>Åbning</th>
            
          </tr>
        </thead>
        <tbody>
          
          <% if (last30Days) { %>
            <% last30Days.forEach(function(day) { %>
              <tr>
                <td><%= day.date %></td>
                <td><%= day.data['1. open'] %></td>
              </tr>
            <% }); %>
          <% } else { %>
            <tr>
              <td colspan="2">Ingen data endnu. Indtast en aktie ovenfor.</td>
            </tr>
          <% } %>
        </tbody>
      </table>

</body>


<script>

const tickers = [
  "ALMB",
  "AMBU B",
  "MAERSK A",
  "MAERSK B",
  "AQP",
  "ATLA DKK",
  "BO",
  "BAVA",
  "AOJ B",
  "CARL A",
  "CARL B",
  "CHR",
  "COLO B",
  "DANSKE",
  "DEMANT",
  "DFDS",
  "DNORD",
  "DSV",
  "FLS",
  "GMAB",
  "GN",
  "LUN",
  "HYDRCT",
  "ISS",
  "JYSK",
  "NETC",
  "NKT",
  "NORTHM",
  "NSIS B",
  "NOVO B",
  "NTG",
  "ORSTED",
  "PNDORA",
  "RBREW",
  "ROCK B",
  "SPNO",
  "SIM",
  "STG",
  "TRYGR",
  "VWS",
  "ORSTED",
  "SIM",
  "STRAP",
  "SPASJ",
  "SPNO",
  "SIM",
  "STG",
  "TRYGR",
  "VWS"
];


const aktienavne = [
    "Alm. Brand A/S",
    "Ambu A/S",
    "A.P. Møller - Mærsk A/S (A)",
    "A.P. Møller - Mærsk A/S (B)",
    "Aquaporin A/S",
    "Atlantic Petroleum",
    "Bang & Olufsen A/S",
    "Bavarian Nordic A/S",
    "Brdr. A&O Johansen A/S (B)",
    "Carlsberg A/S (A)",
    "Carlsberg A/S (B)",
    "Chr. Hansen Holding A/S",
    "Coloplast A/S (B)",
    "Danske Bank A/S",
    "Demant A/S",
    "DFDS A/S",
    "D/S Norden A/S",
    "DSV A/S",
    "FLSmidth & Co. A/S",
    "Genmab A/S",
    "GN Store Nord A/S",
    "H. Lundbeck A/S",
    "Hydract A/S",
    "ISS A/S",
    "Jyske Bank A/S",
    "Netcompany Group A/S",
    "NKT A/S",
    "North Media A/S",
    "Novonesis A/S (B)",
    "Novo Nordisk A/S (B)",
    "NTG Nordic Transport Group A/S",
    "Ørsted A/S",
    "Pandora A/S",
    "Royal Unibrew A/S",
    "Rockwool International A/S (B)",
    "Spar Nord Bank A/S",
    "SimCorp A/S",
    "Scandinavian Tobacco Group A/S",
    "Tryg A/S",
    "Vestas Wind Systems A/S",
    "Ørsted A/S",
    "SimCorp A/S",
    "Strategic Partners A/S",
    "Sparekassen Sjælland",
    "Spar Nord Bank A/S",
    "SimCorp A/S",
    "Scandinavian Tobacco Group A/S",
    "Tryg A/S",
    "Vestas Wind Systems A/S"
  ];




  let stockName = "";

/*
  var last30Days = <%- JSON.stringify(last30Days) %>;

console.log(last30Days[0].data["4. close"]);

let bababoi = last30Days[0].data["4. close"];

  // Nu kan du bruge 'last30Days' i din JavaScript-kode

*/

let bababoi = 0;
  function lavListMedAktier() {
  for (let i = 0; i < aktienavne.length; i++) {
    const button = document.createElement("button");
    button.id = "soi";

    button.name = tickers[i];

    // Først tilføjer vi aktienavnet som tekst
    button.append(aktienavne[i] + " ");

    // Så tilføjer vi span bagefter


    const span = document.createElement("span");
    span.textContent = bababoi + " DKK";
    
    button.appendChild(span);

    button.addEventListener('click', displayStock); // Afspiller displayStock() der viser grafen

    document.getElementById("stockListBox_id").appendChild(button);
  }
}
lavListMedAktier();





// søg efterr aktier //
let userInput_SearchStocks = "";

function searchStocks(event) {
  userInput_SearchStocks = document.getElementById("searchStocks_input_id").value.toLowerCase();

  const buttons = document.querySelectorAll("#stockBox_id button");

  buttons.forEach(button => {
    const text = button.textContent.toLowerCase();
    if (text.includes(userInput_SearchStocks)) {
      button.style.display = "inline-block";
    } else {
      button.style.display = "none";
    }
  });
}
document.getElementById("searchStocks_input_id").addEventListener("keyup", searchStocks);


let boi = [100,110,90,100,110,100,100,90,110,110];



function displayStock(){


  document.getElementById("myChart").innerHTML = "";

  const xValues = [1,2,3,4,5,6,7,8,9,10];
const options = {
      chart: {
        type: 'line',
        height: 350,
        fontFamily: 'normalSkrift'
      },
      colors: ['blue'], // Graflinje farve
      
      series: [{
        name: 'Aktiekurs',
        data: boi
      }],
      xaxis: {
        categories: xValues,
        labels: {
          style: {
            colors: '#fff' // Tekstfarve på x-aksen
          }
        },
        title: {
          text: 'Ugedage',
          style: {
            color: 'lightgray'
          }
        }
      },
      yaxis: {
        labels: {
          style: {
            colors: 'lightgray' // Tekstfarve på y-aksen
          }
        },
        title: {
          text: 'Kurs (DKK)',
          style: {
            color: 'lightgray'
          }
        }
      },
      
      stroke: {
        curve: 'smooth'
      },


      tooltip: {
        theme: 'dark',
        style: {
          fontSize: '14px',
          fontFamily: 'normalSkrift',
          backgroundColor: 'black'
        },
        marker: {
          show: true,
          fillColors: ['blue']
        },
  y: {
    formatter: function (value) {
      return value + " DKK";
    }
  }
},

grid: {
  show: true, // sæt til false hvis du vil skjule alle gitterlinjer
  borderColor: 'gray', // farven på linjerne
  strokeDashArray: 4, // gør dem stiplede (0 = fuldt optrukket)
  xaxis: {
    lines: {
      show: false // fjerner vertikale linjer
    }
  },
  yaxis: {
    lines: {
      show: true // viser horisontale linjer
    }
  }
}

    };

    const chart = new ApexCharts(document.querySelector("#myChart"), options);
    chart.render();

};



function fåPorteføljer(){
  
}




// Logout confirmation
const logoutForm = document.querySelector('form[action="/logout"]');
if (logoutForm) {
  logoutForm.addEventListener("submit", function (event) {
    const confirmed = confirm("Er du sikker på, at du vil logge ud?");
    if (!confirmed) {
      event.preventDefault(); // Stopper formularen
    }
  });
}
</script>