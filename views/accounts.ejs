<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accounts</title>
  <link rel="stylesheet" href="accounts_style.css">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
</head>

<body>
  <!-- Top Bar -->
  <div id="topBar_id">
    <h1>PORTFOLIOTRACKER</h1>
    <form action="/logout" method="POST" style="display: inline;">
      <button type="submit" id="logoutButton" title="Log ud">
        <span class="material-symbols-outlined">
          account_circle_off
        </span>
      </button>
    </form>
  </div>

  <!-- Side Navigation -->
  <ul>
    <li><a href="/dashboard?userId=<%= userId %>"><span class="material-symbols-outlined">dashboard</span>Dashboard</a>
    </li>
    <li><a href="/portfolios?userId=<%= userId %>"><span
          class="material-symbols-outlined">folder_open</span>Portfolios</a></li>
    <li><a href="/trade?userId=<%= userId %>"><span class="material-symbols-outlined">query_stats</span>Market</a></li>
    <li><a href="/accounts?userId=<%= userId %>" style="color: gray;"><span class="material-symbols-outlined"
          style="color: gray;">account_balance_wallet</span>Accounts</a></li>
    <li><a href="/profile?userId=<%= userId %>"><span class="material-symbols-outlined">person</span>Profile</a></li>
  </ul>

  <!-- Main Content -->
  <div id="mainContent">
    <!-- Kontooversigt -->
    <div id="accountsContainer">
      <h2>Kontooversigt</h2>
      <% if (accounts.length===0) { %>
        <div class="account">
          <h3>Konto Navn: Opsparing</h3>
          <p>Valuta: DKK</p>
          <p>Saldo: 10.000 DKK</p>
          <p>Oprettet: 2025-04-01</p>
          <p>Bank: Danske Bank</p>
          <button class="deposit-account">Indbetal</button>
          <button class="withdraw-account">Udbetal</button>
          <button class="reopen-account">Genåbn Konto</button>
        </div>
        <% } else { %>
          <% accounts.forEach(account=> { %>
            <div class="account">
              <h3>Konto Navn: <%= account.name %>
              </h3>
              <p>Valuta: <%= account.currency %>
              </p>
              <p>Saldo: <%= account.balance %>
                  <%= account.currency %>
              </p>
              <p>Oprettet: <%= account.created_at.toISOString().split('T')[0] %>
              </p>
              <p>Bank: <%= account.bank %>
              </p>
              <% if (account.closed_at) { %>
                <p style="color:red;">Kontoen er lukket den <%= account.closed_at.toISOString().split("T")[0] %>
                </p>
                <% } %>
                  <% if (!account.closed_at) { %>
                    <!-- Indbetalingsformular. -->
                    <form action="/deposit?userId=<%= userId %>" method="POST" style="display:inline;">
                      <input type="hidden" name="accountId" value="<%= account.id %>">
                      <input type="number" name="amount" placeholder="Beløb" required>
                      <button type="submit" class="deposit-account">Indbetal</button>
                    </form>
                    <!-- Udbetalingsformular. -->
                    <form action="/withdraw?userId=<%= userId %>" method="POST" style="display:inline;">
                      <input type="hidden" name="accountId" value="<%= account.id %>">
                      <input type="number" name="amount" placeholder="Beløb" step="0.01" required>
                      <button type="submit" class="withdraw-account">Udbetal</button>
                    </form>
                    <% } %>
                      <form action="/close-account?userId=<%= userId %>" method="POST" style="display:inline;">
                        <input type="hidden" name="accountId" value="<%= account.id %>">
                        <button type="submit" class="close-account">Luk Konto</button>
                      </form>
                      <form action="/reopen-account?userId=<%= userId %>" method="POST" style="display:inline;">
                        <input type="hidden" name="accountId" value="<%= account.id %>">
                        <button type="submit" class="reopen-account">Genåbn Konto</button>
                      </form>
                      <!-- Se transaktioner-knap -->
                      <form action="/transactions" method="GET" style="display:inline;">
                        <input type="hidden" name="accountId" value="<%= account.id %>">
                        <button type="submit">Se transaktioner</button>
                      </form>
            </div>
            <% }) %>
              <% } %>
    </div>

    <!-- Opret ny konto -->
    <div id="createAccountContainer">
      <h2>Opret ny konto</h2>
      <form action="/create-account?userId=<%= userId %>" method="POST">
        <input type="hidden" name="userId" value="<%= userId %>">
        <label>Kontonavn:</label>
        <input type="text" name="name" required>
        <label>Valuta:</label>
        <input type="text" name="currency" placeholder="DKK, USD, EUR..." required>
        <label>Banknavn:</label>
        <input type="text" name="bank" required>
        <button type="submit">Opret Konto</button>
      </form>
    </div>
  </div>
</body>

</html>